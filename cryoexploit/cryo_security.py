import numpy as np
from pykalman import KalmanFilter

def detect_sensor_spoofing(temp_readings: list, threshold: float = 5.0) -> bool:
    """
    Use Kalman filter to detect spoofed sensor values.
    Returns True if anomaly is detected.
    """
    kf = KalmanFilter(initial_state_mean=temp_readings[0], n_dim_obs=1)
    smoothed, _ = kf.smooth(np.array(temp_readings).reshape(-1, 1))
    deviation = abs(temp_readings[-1] - smoothed[-1][0])
    return deviation > threshold

def validate_signatures(signatures: list, required: int = 3) -> bool:
    """
    Check if enough valid signatures are present.
    """
    return len(signatures) >= required
